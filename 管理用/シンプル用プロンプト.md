# Network Visualizer 再作成プロンプト

以下の仕様に従って、Cytoscape.jsベースのネットワーク可視化Webアプリケーションを作成してください。

---

## プロジェクト概要

**アプリケーション名**: Network Visualizer  
**目的**: Excelファイルからネットワークデータを読み込み、インタラクティブなグラフとして可視化するWebアプリケーション

---

## 技術スタック

- HTML5, CSS3, JavaScript (ES6+)
- Cytoscape.js 3.28.1（グラフ可視化）
- cytoscape-klay（階層型レイアウト）
- SheetJS (xlsx) 0.18.5（Excel読み込み）


---

## 機能要件

### 1. メニューバー

固定ヘッダーのメニューバーを作成してください：

- **File**
  - Import（サブメニュー）
    - Network File: ネットワークファイル（Excel）インポート
    - Table File: テーブルファイルインポート（既存ノードに属性追加）
- **Layout**
  - Hierarchical（サブメニュー）
    - Defaults: klayレイアウト適用
    - Equal: 縦横比1:1で均等配置

---

### 2. ファイルインポート機能

#### Network File インポート
1. メニューからNetwork Fileを選択するとファイル選択ダイアログを開く
2. ファイル選択後、カラムマッピングモーダルを表示
3. モーダルでは各カラムに対して以下を設定：
   - **Role**: Source / Target / Attribute / None
   - **Data Type**: String / Number / Boolean / Date / String Array / Number Array / Date Array
   - **Delimiter**: Array型の区切り文字（デフォルト: `|`）
4. Importボタンでネットワークを作成し、klayレイアウトを適用し行単位でノードの名前順に並び替え

#### Table File インポート
1. 既存ネットワークが必要
2. Source（キー）カラムを指定して既存ノードにマッチ
3. 他のカラムを属性として既存ノードに追加

#### 対応ファイル形式
- Excel（.xlsx, .xls）

---

### 3. グラフ表示領域

- Cytoscape.jsを使用したインタラクティブなグラフ表示
- ズーム（マウスホイール）、パン（背景ドラッグ）対応
- ノードのドラッグ移動
- クリック/Ctrl+クリックによる選択

#### デフォルトスタイル

- ノード: 青色円形（#2563eb）、サイズ40px
- エッジ: グレー線（#94a3b8）、矢印付きbezierカーブ
- 選択時: オレンジ色に変化



### 8. Equalize レイアウト

- 縦横比1:1で各階層のノードを均等配置
- Y座標で階層を識別し、各階層内でノードを均等配置

---

## UI/UX要件

### カラースキーム
```css
--primary-color: #2563eb;
--secondary-color: #64748b;
--background-color: #f8fafc;
--menubar-bg: #1e293b;
--border-color: #e2e8f0;
--text-color: #1e293b;
```

### モーダルウィンドウ
- 背景オーバーレイ（半透明黒）
- 中央配置、アニメーション表示
- 背景クリックで閉じる

### プログレスオーバーレイ
- ファイル読み込み等の処理中に表示
- スピナーアニメーション
- 画面操作をブロック

---

## 実装上の注意点

1. **モジュール構成**: 各機能を独立したクラスとして実装
2. **グローバルインスタンス**: networkManager, fileHandler等はグローバルアクセス可能に
3. **レスポンシブ**: ウィンドウリサイズに対応

---

## インポート用サンプルファイル
sample_import_fileフォルダ内
　Network File：Network.xlsx
　Table File：Node.xlsx、Node with classification.xlsx
　

---

各ステップごとに動作確認しながら進めてください。
